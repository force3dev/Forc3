(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[933],{9584:function(e,t,s){Promise.resolve().then(s.bind(s,9421))},6463:function(e,t,s){"use strict";var a=s(1169);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},9421:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return u}});var a=s(7437),l=s(2265),r=s(6463);let n=[45,35,25,10,5,2.5],i=[20,15,10,5,2.5,1.25];function o(e){let{duration:t,totalVolume:r,totalSets:n,prCount:i,newAchievements:o=[],onClose:c}=e,d=(0,l.useRef)(!1);return(0,l.useEffect)(()=>{d.current||(d.current=!0,s.e(965).then(s.bind(s,965)).then(e=>{let{default:t}=e,s=Date.now()+3e3,a=()=>{t({particleCount:3,angle:60,spread:55,origin:{x:0},colors:["#0066FF","#00C853","#FFB300"]}),t({particleCount:3,angle:120,spread:55,origin:{x:1},colors:["#0066FF","#00C853","#FFB300"]}),Date.now()<s&&requestAnimationFrame(a)};a()}))},[]),(0,a.jsxs)("div",{className:"fixed inset-0 z-50 bg-black flex flex-col items-center justify-center px-6 text-center",children:[(0,a.jsx)("div",{className:"text-6xl mb-4",children:"\uD83C\uDFC6"}),(0,a.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"Workout Complete!"}),(0,a.jsx)("p",{className:"text-neutral-400 mb-8",children:"Great work — keep showing up"}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4 w-full max-w-sm mb-8",children:[(0,a.jsxs)("div",{className:"bg-[#141414] border border-[#262626] rounded-2xl p-4",children:[(0,a.jsxs)("div",{className:"text-2xl font-bold tabular-nums",children:[Math.floor(t/60),":",String(t%60).padStart(2,"0")]}),(0,a.jsx)("div",{className:"text-xs text-neutral-500 mt-1",children:"Duration"})]}),(0,a.jsxs)("div",{className:"bg-[#141414] border border-[#262626] rounded-2xl p-4",children:[(0,a.jsx)("div",{className:"text-2xl font-bold tabular-nums",children:r>=1e3?"".concat((r/1e3).toFixed(1),"k"):r}),(0,a.jsx)("div",{className:"text-xs text-neutral-500 mt-1",children:"lbs lifted"})]}),(0,a.jsxs)("div",{className:"bg-[#141414] border border-[#262626] rounded-2xl p-4",children:[(0,a.jsx)("div",{className:"text-2xl font-bold tabular-nums",children:n}),(0,a.jsx)("div",{className:"text-xs text-neutral-500 mt-1",children:"Sets done"})]})]}),i>0&&(0,a.jsx)("div",{className:"mb-6 px-5 py-3 bg-[#FFB300]/10 border border-[#FFB300]/30 rounded-2xl",children:(0,a.jsxs)("p",{className:"text-[#FFB300] font-bold",children:["\uD83C\uDFAF ",i," new personal record",1!==i?"s":"","!"]})}),o.length>0&&(0,a.jsxs)("div",{className:"w-full max-w-sm mb-6",children:[(0,a.jsx)("p",{className:"text-sm text-neutral-400 mb-3",children:"New achievements unlocked!"}),(0,a.jsx)("div",{className:"space-y-2",children:o.map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-3 bg-[#141414] border border-[#262626] rounded-xl p-3",children:[(0,a.jsx)("span",{className:"text-2xl",children:e.icon}),(0,a.jsx)("div",{className:"flex-1 text-left",children:(0,a.jsx)("div",{className:"font-semibold text-sm",children:e.name})}),(0,a.jsxs)("div",{className:"text-[#FFB300] text-sm font-bold",children:["+",e.xpReward," XP"]})]},e.name))})]}),(0,a.jsx)("button",{onClick:c,className:"w-full max-w-sm py-4 bg-[#0066FF] text-white font-bold rounded-2xl hover:bg-[#0052CC] transition-colors",children:"Done"})]})}function c(e){let{seconds:t,onDone:s}=e,[r,n]=(0,l.useState)(t),[i,o]=(0,l.useState)(!0);(0,l.useEffect)(()=>{if(!i)return;let e=setInterval(()=>{n(t=>t<=1?(clearInterval(e),o(!1),s(),0):t-1)},1e3);return()=>clearInterval(e)},[i,s]);let c=(t-r)/t*100;return(0,a.jsx)("div",{className:"fixed inset-0 bg-black/90 flex items-center justify-center z-50 p-6",children:(0,a.jsxs)("div",{className:"w-full max-w-xs text-center space-y-6",children:[(0,a.jsx)("p",{className:"text-neutral-400 text-sm uppercase tracking-widest",children:"Rest"}),(0,a.jsxs)("div",{className:"relative w-40 h-40 mx-auto",children:[(0,a.jsxs)("svg",{className:"w-full h-full -rotate-90",viewBox:"0 0 160 160",children:[(0,a.jsx)("circle",{cx:"80",cy:"80",r:"70",fill:"none",stroke:"#1a1a1a",strokeWidth:"8"}),(0,a.jsx)("circle",{cx:"80",cy:"80",r:"70",fill:"none",stroke:"#0066FF",strokeWidth:"8",strokeDasharray:"".concat(2*Math.PI*70),strokeDashoffset:"".concat(2*Math.PI*70*(1-c/100)),strokeLinecap:"round",style:{transition:"stroke-dashoffset 1s linear"}})]}),(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,a.jsxs)("span",{className:"text-4xl font-bold tabular-nums",children:[Math.floor(r/60),":",(r%60).toString().padStart(2,"0")]})})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("button",{onClick:()=>{n(e=>Math.max(0,e-30))},className:"flex-1 py-3 bg-[#1a1a1a] rounded-xl text-sm",children:"−30s"}),(0,a.jsx)("button",{onClick:()=>{o(!1),s()},className:"flex-1 py-3 bg-[#0066FF] rounded-xl font-semibold",children:"Skip"}),(0,a.jsx)("button",{onClick:()=>{n(e=>e+30)},className:"flex-1 py-3 bg-[#1a1a1a] rounded-xl text-sm",children:"+30s"})]})]})})}function d(e){let{prType:t,onDone:s}=e;return(0,l.useEffect)(()=>{let e=setTimeout(s,3e3);return()=>clearTimeout(e)},[s]),(0,a.jsx)("div",{className:"fixed inset-0 bg-black/95 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"text-center space-y-4",children:[(0,a.jsx)("div",{className:"text-6xl animate-bounce",children:"\uD83C\uDFC6"}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-[#FFB300]",children:"New PR!"}),(0,a.jsx)("p",{className:"text-neutral-400",children:"1rm"===t?"New estimated 1-rep max!":"volume"===t?"New volume PR — most reps \xd7 weight in a set!":"Personal Record Broken!"}),(0,a.jsx)("button",{onClick:s,className:"px-6 py-2 bg-[#FFB300]/20 text-[#FFB300] border border-[#FFB300]/30 rounded-xl text-sm font-semibold",children:"Let's go!"})]})})}function x(e){let{weight:t,onClose:s}=e,[r,o]=(0,l.useState)(t),c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"lbs",s="lbs"===t?45:20,a=[],l=Math.max(0,(e-s)/2);for(let e of"lbs"===t?n:i)if(l>=e){let t=Math.floor(l/e);a.push({weight:e,count:t}),l-=e*t,l=Math.round(100*l)/100}let r=s+a.reduce((e,t)=>e+t.weight*t.count*2,0);return{bar:s,platesPerSide:a,totalWeight:r,unit:t}}(r,"lbs");return(0,a.jsx)("div",{className:"fixed inset-0 bg-black/90 z-50 flex items-end",children:(0,a.jsxs)("div",{className:"w-full bg-[#141414] border-t border-[#262626] rounded-t-2xl p-6 space-y-5",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"font-bold text-lg",children:"Plate Calculator"}),(0,a.jsx)("button",{onClick:s,className:"text-neutral-500 text-lg",children:"✕"})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:"number",value:r,onChange:e=>o(parseFloat(e.target.value)||0),className:"w-full p-4 pr-16 bg-[#0a0a0a] border border-[#262626] rounded-xl text-center text-2xl font-bold focus:border-[#0066FF] focus:outline-none",step:2.5}),(0,a.jsx)("span",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-neutral-500",children:"lbs"})]}),(0,a.jsxs)("div",{className:"bg-[#0a0a0a] rounded-xl p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm mb-3",children:[(0,a.jsxs)("span",{className:"text-neutral-400",children:["Bar: ",c.bar," lbs"]}),(0,a.jsx)("span",{className:"text-neutral-400",children:"Per side:"})]}),c.platesPerSide.length>0?(0,a.jsx)("div",{className:"space-y-2",children:c.platesPerSide.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"flex gap-2",children:Array.from({length:e.count}).map((t,s)=>(0,a.jsx)("div",{className:"h-8 rounded-md flex items-center justify-center text-xs font-bold text-black",style:{width:Math.max(24,.8*e.weight)+"px",background:e.weight>=45?"#FFB300":e.weight>=25?"#0066FF":e.weight>=10?"#00C853":"#A0A0A0"},children:e.weight},s))}),(0,a.jsxs)("span",{className:"text-neutral-400 text-sm",children:[e.count,"\xd7",e.weight]})]},t))}):(0,a.jsx)("p",{className:"text-neutral-500 text-sm text-center",children:"Bar only"}),(0,a.jsxs)("div",{className:"mt-3 pt-3 border-t border-[#262626] flex justify-between text-sm font-semibold",children:[(0,a.jsx)("span",{children:"Total"}),(0,a.jsxs)("span",{children:[c.totalWeight," lbs"]})]})]})]})})}function u(){let e=(0,r.useRouter)(),t=(0,r.useParams)().id,[s,n]=(0,l.useState)(!0),[i,u]=(0,l.useState)(null),[h,p]=(0,l.useState)(null),[b,g]=(0,l.useState)(null),[f,j]=(0,l.useState)(!1),[N,v]=(0,l.useState)(120),[w,F]=(0,l.useState)(!1),[y,k]=(0,l.useState)(135),[C,S]=(0,l.useState)(!1),[P,B]=(0,l.useState)(null),[R,D]=(0,l.useState)(!1),[M,T]=(0,l.useState)(!1),[I,A]=(0,l.useState)(null),W=(0,l.useRef)(Date.now());(0,l.useEffect)(()=>{!async function(){try{let t=await fetch("/api/workouts/today"),s=await t.json();if(!s.workout){e.push("/dashboard");return}let a=s.workout,l=a.exercises.map(e=>({...e,progressionBadge:e.progressionBadge||null,progressionReason:e.progressionReason||null,loggedSets:Array.from({length:e.sets},(t,s)=>({setNumber:s+1,weight:e.suggestedWeight||e.lastWeight||45,reps:e.repsMax,logged:!1}))}));u({id:a.id,name:a.name,exercises:l,coachingNotes:a.coachingNotes||[]});let r=await fetch("/api/workouts/log",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"start",workoutId:a.id})}),n=await r.json();p(n.logId)}catch(e){console.error(e)}finally{n(!1)}}()},[e,t]);let E=(e,t,s)=>{u(a=>{if(!a)return a;let l=[...a.exercises],r=[...l[e].loggedSets];return r[t]={...r[t],...s},l[e]={...l[e],loggedSets:r},{...a,exercises:l}})},O=(0,l.useCallback)(async(e,t)=>{if(!i||!h)return;let s=i.exercises[e],a=s.loggedSets[t],l=await fetch("/api/workouts/log",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"log_set",logId:h,exerciseId:s.exerciseId,setNumber:a.setNumber,weight:a.weight,reps:a.reps,rpe:a.rpe})}),r=await l.json();r.isPR&&(B(r.prType||null),S(!0)),E(e,t,{logged:!0,isPR:r.isPR}),v(s.restSeconds||120),j(!0)},[i,h]),_=async()=>{if(h){D(!0);try{let e=await fetch("/api/workouts/log",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"complete",logId:h})}),t=await e.json();A({duration:60*t.duration,totalVolume:t.totalVolume,prCount:t.prCount||0,newAchievements:t.newAchievements||[]}),T(!0)}finally{D(!1)}}};if(s)return(0,a.jsx)("main",{className:"min-h-screen bg-black flex items-center justify-center",children:(0,a.jsx)("div",{className:"w-8 h-8 border-2 border-[#0066FF] border-t-transparent rounded-full animate-spin"})});if(!i)return(0,a.jsx)("main",{className:"min-h-screen bg-black text-white flex items-center justify-center p-6",children:(0,a.jsxs)("div",{className:"text-center space-y-4",children:[(0,a.jsx)("p",{className:"text-neutral-400",children:"Workout not found"}),(0,a.jsx)("button",{onClick:()=>e.push("/dashboard"),className:"text-[#0066FF] underline",children:"Back to Dashboard"})]})});if(M&&I){let t=i.exercises.reduce((e,t)=>e+t.loggedSets.filter(e=>e.logged).length,0);return(0,a.jsx)(o,{duration:I.duration,totalVolume:I.totalVolume,totalSets:t,prCount:I.prCount,newAchievements:I.newAchievements,onClose:()=>e.push("/dashboard")})}let L=i.exercises.filter(e=>e.loggedSets.every(e=>e.logged)).length;return(0,a.jsxs)("main",{className:"min-h-screen bg-black text-white pb-6",children:[f&&(0,a.jsx)(c,{seconds:N,onDone:()=>j(!1)}),C&&(0,a.jsx)(d,{prType:P,onDone:()=>{S(!1),B(null)}}),w&&(0,a.jsx)(x,{weight:y,onClose:()=>F(!1)}),(0,a.jsxs)("header",{className:"px-5 pt-6 pb-4 flex items-center justify-between border-b border-[#1a1a1a]",children:[(0,a.jsx)("button",{onClick:()=>e.push("/dashboard"),className:"text-neutral-500 text-sm hover:text-white transition-colors",children:"← Exit"}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"font-bold",children:i.name}),(0,a.jsxs)("div",{className:"text-xs text-neutral-500",children:[L,"/",i.exercises.length," exercises"]})]}),(0,a.jsx)("div",{className:"text-xs text-neutral-500 tabular-nums",children:(0,a.jsx)(m,{startTime:W.current})})]}),(0,a.jsx)("div",{className:"px-5 py-3 flex gap-1.5",children:i.exercises.map((e,t)=>(0,a.jsx)("div",{className:"h-1 flex-1 rounded-full transition-colors ".concat(e.loggedSets.every(e=>e.logged)?"bg-[#0066FF]":b===t?"bg-[#0066FF]/50":"bg-[#262626]")},e.id))}),i.coachingNotes&&i.coachingNotes.length>0&&(0,a.jsxs)("div",{className:"mx-5 mb-3 bg-[#0066FF]/5 border border-[#0066FF]/20 rounded-xl p-3 space-y-1.5",children:[(0,a.jsx)("p",{className:"text-xs text-[#0066FF] font-semibold uppercase tracking-wide",children:"Coach Tips"}),i.coachingNotes.map((e,t)=>(0,a.jsx)("p",{className:"text-xs text-neutral-300",children:e},t))]}),(0,a.jsx)("div",{className:"px-5 space-y-3",children:i.exercises.map((e,t)=>{let s=b===t,l=e.loggedSets.every(e=>e.logged),r=e.loggedSets.filter(e=>e.logged).length;return(0,a.jsxs)("div",{className:"rounded-2xl border overflow-hidden transition-all ".concat(s?"border-[#0066FF]/50 bg-[#141414]":l?"border-[#262626] bg-[#0a0a0a] opacity-75":"border-[#262626] bg-[#141414]"),children:[(0,a.jsxs)("button",{className:"w-full px-5 py-4 flex items-center justify-between text-left",onClick:()=>g(s?null:t),children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0 mr-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[l&&(0,a.jsx)("span",{className:"text-[#00C853] text-sm",children:"✓"}),(0,a.jsx)("span",{className:"font-semibold ".concat(l?"text-neutral-400":"text-white"),children:e.name}),e.progressionBadge&&!l&&(0,a.jsx)("span",{className:"text-xs font-bold px-2 py-0.5 rounded-full bg-[#0066FF]/20 text-[#0066FF] border border-[#0066FF]/30",children:e.progressionBadge})]}),(0,a.jsxs)("div",{className:"text-xs text-neutral-500 mt-0.5",children:[e.sets," sets \xd7 ",e.repsMin,"–",e.repsMax," reps",e.rpe?" @ RPE ".concat(e.rpe):"",e.lastWeight?" • Last: ".concat(e.lastWeight," lbs"):""]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("span",{className:"text-xs text-neutral-600",children:[r,"/",e.sets]}),(0,a.jsx)("svg",{className:"w-4 h-4 text-neutral-600 transition-transform ".concat(s?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),s&&(0,a.jsxs)("div",{className:"px-5 pb-5 space-y-3 border-t border-[#1a1a1a]",children:[e.progressionReason&&(0,a.jsx)("div",{className:"pt-3",children:(0,a.jsx)("p",{className:"text-xs text-[#0066FF]/80 bg-[#0066FF]/10 border border-[#0066FF]/20 rounded-lg px-3 py-2",children:e.progressionReason})}),e.lastSets.length>0&&(0,a.jsxs)("div",{className:"pt-3",children:[(0,a.jsx)("p",{className:"text-xs text-neutral-600 mb-1.5",children:"Last session:"}),(0,a.jsx)("div",{className:"flex gap-2 flex-wrap",children:e.lastSets.map((e,t)=>(0,a.jsxs)("span",{className:"text-xs bg-[#0a0a0a] border border-[#262626] px-2 py-1 rounded-lg text-neutral-400",children:[e.weight,"\xd7",e.reps]},t))})]}),(0,a.jsx)("div",{className:"pt-2 space-y-2",children:e.loggedSets.map((e,s)=>(0,a.jsx)("div",{className:"p-3 rounded-xl border ".concat(e.logged?"bg-[#0066FF]/10 border-[#0066FF]/30":"bg-[#0a0a0a] border-[#262626]"),children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("span",{className:"text-xs text-neutral-500 w-10",children:e.logged?"✓":"Set ".concat(e.setNumber)}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>{E(t,s,{weight:Math.max(0,e.weight-2.5)})},className:"w-8 h-8 rounded-lg bg-[#1a1a1a] flex items-center justify-center text-neutral-400 hover:text-white",children:"−"}),(0,a.jsx)("input",{type:"number",value:e.weight,onChange:e=>E(t,s,{weight:parseFloat(e.target.value)||0}),onClick:()=>{k(e.weight)},className:"flex-1 bg-transparent text-center font-bold text-lg focus:outline-none w-16",step:2.5}),(0,a.jsx)("button",{onClick:()=>E(t,s,{weight:e.weight+2.5}),className:"w-8 h-8 rounded-lg bg-[#1a1a1a] flex items-center justify-center text-neutral-400 hover:text-white",children:"+"})]}),(0,a.jsx)("div",{className:"text-center text-xs text-neutral-600",children:"lbs"})]}),(0,a.jsx)("span",{className:"text-neutral-600",children:"\xd7"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>E(t,s,{reps:Math.max(1,e.reps-1)}),className:"w-8 h-8 rounded-lg bg-[#1a1a1a] flex items-center justify-center text-neutral-400 hover:text-white",children:"−"}),(0,a.jsx)("input",{type:"number",value:e.reps,onChange:e=>E(t,s,{reps:parseInt(e.target.value)||0}),className:"flex-1 bg-transparent text-center font-bold text-lg focus:outline-none w-16"}),(0,a.jsx)("button",{onClick:()=>E(t,s,{reps:e.reps+1}),className:"w-8 h-8 rounded-lg bg-[#1a1a1a] flex items-center justify-center text-neutral-400 hover:text-white",children:"+"})]}),(0,a.jsx)("div",{className:"text-center text-xs text-neutral-600",children:"reps"})]}),!e.logged&&(0,a.jsx)("button",{onClick:()=>O(t,s),className:"w-10 h-10 rounded-xl bg-[#0066FF] flex items-center justify-center text-white font-bold text-lg hover:bg-[#0052CC] transition-colors",children:"✓"}),e.isPR&&(0,a.jsx)("span",{className:"text-[#FFB300] text-xs font-bold",children:"PR!"})]})},s))}),(0,a.jsxs)("div",{className:"flex gap-2 pt-1",children:[(0,a.jsx)("button",{onClick:()=>{var t;k((null===(t=e.loggedSets[0])||void 0===t?void 0:t.weight)||135),F(!0)},className:"flex-1 py-2.5 bg-[#0a0a0a] border border-[#262626] rounded-xl text-xs text-neutral-400 hover:text-white transition-colors",children:"\uD83D\uDD22 Plate Calc"}),(0,a.jsx)("button",{onClick:()=>{v(e.restSeconds||120),j(!0)},className:"flex-1 py-2.5 bg-[#0a0a0a] border border-[#262626] rounded-xl text-xs text-neutral-400 hover:text-white transition-colors",children:"⏱ Rest Timer"})]})]})]},e.id)})}),(0,a.jsx)("div",{className:"px-5 mt-6",children:(0,a.jsx)("button",{onClick:_,disabled:R,className:"w-full py-4 font-bold rounded-xl transition-all ".concat(R?"bg-neutral-800 text-neutral-500 cursor-not-allowed":"bg-[#0066FF] text-white hover:bg-[#0052CC]"),children:R?"Saving...":"Complete Workout"})})]})}function m(e){let{startTime:t}=e,[s,r]=(0,l.useState)(0);return(0,l.useEffect)(()=>{let e=setInterval(()=>{r(Math.floor((Date.now()-t)/1e3))},1e3);return()=>clearInterval(e)},[t]),(0,a.jsxs)(a.Fragment,{children:[Math.floor(s/60),":",(s%60).toString().padStart(2,"0")]})}}},function(e){e.O(0,[971,23,744],function(){return e(e.s=9584)}),_N_E=e.O()}]);