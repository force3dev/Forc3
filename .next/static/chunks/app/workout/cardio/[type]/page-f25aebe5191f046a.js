(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1929],{61680:function(e,t,n){Promise.resolve().then(n.bind(n,98728))},16463:function(e,t,n){"use strict";var s=n(71169);n.o(s,"useParams")&&n.d(t,{useParams:function(){return s.useParams}}),n.o(s,"useRouter")&&n.d(t,{useRouter:function(){return s.useRouter}}),n.o(s,"useSearchParams")&&n.d(t,{useSearchParams:function(){return s.useSearchParams}})},98728:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return x}});var s=n(57437),a=n(2265),l=n(16463),r=n(36106);function i(e){let{onStart:t}=e,[n,l]=(0,a.useState)([{type:"work",duration:30,name:"Sprint"},{type:"rest",duration:30,name:"Rest"}]),[r,i]=(0,a.useState)(8),o=n.reduce((e,t)=>e+t.duration,0)*r,c=(e,t)=>{l(n=>n.map((n,s)=>s===e?{...n,...t}:n))},u=e=>{l(t=>[...t,{type:e,duration:30,name:"work"===e?"Sprint":"Rest"}])},d=e=>{l(t=>t.filter((t,n)=>n!==e))};return(0,s.jsxs)("div",{className:"p-5 space-y-5",children:[(0,s.jsx)("h2",{className:"text-xl font-bold",children:"Build Your HIIT"}),(0,s.jsx)("div",{className:"space-y-2",children:n.map((e,t)=>(0,s.jsxs)("div",{className:"border rounded-xl p-3 flex items-center gap-3 ".concat("work"===e.type?"bg-red-900/10 border-red-900/30":"bg-green-900/10 border-green-900/30"),children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded-full flex-shrink-0 ".concat("work"===e.type?"bg-red-500":"bg-[#00C853]")}),(0,s.jsx)("input",{type:"text",value:e.name,onChange:e=>c(t,{name:e.target.value}),className:"flex-1 bg-transparent text-sm font-medium focus:outline-none"}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("input",{type:"number",value:e.duration,onChange:e=>c(t,{duration:parseInt(e.target.value)||10}),min:5,className:"w-14 bg-black/40 border border-[#262626] rounded-lg px-2 py-1 text-center text-sm focus:border-[#0066FF] focus:outline-none"}),(0,s.jsx)("span",{className:"text-neutral-500 text-xs",children:"sec"})]}),n.length>2&&(0,s.jsx)("button",{onClick:()=>d(t),className:"text-neutral-600 hover:text-red-400 text-lg leading-none",children:"\xd7"})]},t))}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsx)("button",{onClick:()=>u("work"),className:"py-2.5 bg-red-900/20 text-red-400 rounded-xl text-sm font-semibold hover:bg-red-900/30 transition-colors",children:"+ Work"}),(0,s.jsx)("button",{onClick:()=>u("rest"),className:"py-2.5 bg-green-900/20 text-[#00C853] rounded-xl text-sm font-semibold hover:bg-green-900/30 transition-colors",children:"+ Rest"})]}),(0,s.jsxs)("div",{className:"bg-[#141414] border border-[#262626] rounded-xl p-4 flex items-center justify-between",children:[(0,s.jsx)("span",{className:"font-semibold",children:"Rounds"}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("button",{onClick:()=>i(e=>Math.max(1,e-1)),className:"w-8 h-8 rounded-full bg-[#262626] flex items-center justify-center text-xl font-bold hover:bg-[#333] transition-colors",children:"−"}),(0,s.jsx)("span",{className:"text-2xl font-bold w-8 text-center",children:r}),(0,s.jsx)("button",{onClick:()=>i(e=>e+1),className:"w-8 h-8 rounded-full bg-[#262626] flex items-center justify-center text-xl font-bold hover:bg-[#333] transition-colors",children:"+"})]})]}),(0,s.jsxs)("div",{className:"text-center text-sm",children:[(0,s.jsx)("span",{className:"text-neutral-500",children:"Total Time: "}),(0,s.jsx)("span",{className:"font-bold text-[#0066FF]",children:"".concat(Math.floor(o/60),":").concat((o%60).toString().padStart(2,"0"))})]}),(0,s.jsx)("button",{onClick:()=>t({intervals:n,rounds:r}),className:"w-full py-4 bg-[#0066FF] text-white font-bold rounded-xl hover:bg-[#0052CC] transition-colors",children:"Start HIIT"})]})}let o={running:{name:"Running",icon:"\uD83C\uDFC3",hasGPS:!0,hasIntervals:!1},cycling:{name:"Cycling",icon:"\uD83D\uDEB4",hasGPS:!0,hasIntervals:!1},swimming:{name:"Swimming",icon:"\uD83C\uDFCA",hasGPS:!1,hasIntervals:!1},hiit:{name:"HIIT",icon:"⚡",hasGPS:!1,hasIntervals:!0},rowing:{name:"Rowing",icon:"\uD83D\uDEA3",hasGPS:!1,hasIntervals:!1},jump_rope:{name:"Jump Rope",icon:"\uD83E\uDEA2",hasGPS:!1,hasIntervals:!1},elliptical:{name:"Elliptical",icon:"\uD83D\uDD01",hasGPS:!1,hasIntervals:!1},walking:{name:"Walking",icon:"\uD83D\uDEB6",hasGPS:!0,hasIntervals:!1},stair_climber:{name:"Stair Climber",icon:"\uD83E\uDE9C",hasGPS:!1,hasIntervals:!1},sports:{name:"Sports",icon:"⚽",hasGPS:!1,hasIntervals:!1}};function c(e){let t=Math.floor(e/3600),n=Math.floor(e%3600/60),s=e%60;return t>0?"".concat(t,":").concat(n.toString().padStart(2,"0"),":").concat(s.toString().padStart(2,"0")):"".concat(n.toString().padStart(2,"0"),":").concat(s.toString().padStart(2,"0"))}function u(e){if(!e||!isFinite(e))return"--:--";let t=Math.floor(e);return"".concat(t,":").concat(Math.round((e-t)*60).toString().padStart(2,"0"))}function d(e){let{label:t,value:n,unit:a}=e;return(0,s.jsxs)("div",{className:"bg-[#141414] border border-[#262626] rounded-2xl p-4 text-center",children:[(0,s.jsxs)("div",{className:"text-3xl font-bold font-mono",children:[n,(0,s.jsx)("span",{className:"text-base text-neutral-500 ml-1",children:a})]}),(0,s.jsx)("div",{className:"text-xs text-neutral-500 mt-1",children:t})]})}function x(){let e=(0,l.useRouter)(),t=(0,l.useParams)(),n=(0,l.useSearchParams)(),x=t.type,m=n.get("sport"),h=(0,a.useMemo)(()=>r.zr.find(e=>e.id===x)||null,[x]),b=(null==h?void 0:h.type)==="sprint"?"running":(null==h?void 0:h.type)||x,p=o[b]||{name:b,icon:"\uD83C\uDFC3",hasGPS:!1,hasIntervals:!1},[f,g]=(0,a.useState)(h?"preview":p.hasIntervals?"setup":"tracking"),[v,j]=(0,a.useState)(!1),[N,k]=(0,a.useState)(0),[S,w]=(0,a.useState)(0),[y,C]=(0,a.useState)(0),[P,D]=(0,a.useState)(!1),[I,F]=(0,a.useState)(null),[M,R]=(0,a.useState)(0),[G,E]=(0,a.useState)(1),[T,_]=(0,a.useState)(0),B=(0,a.useRef)(void 0),A=(0,a.useRef)(void 0),H=(0,a.useRef)(null),W=(0,a.useRef)([]);(0,a.useEffect)(()=>{var e;(null==h?void 0:null===(e=h.intervals)||void 0===e?void 0:e.length)&&F({rounds:1,intervals:h.intervals.map(e=>({type:e.label.toLowerCase().includes("rest")?"rest":"work",duration:function(e){let t=e.trim().toLowerCase(),n=t.match(/(\d+)\s*min/);if(n)return 60*Number(n[1]);let s=t.match(/(\d+)\s*(sec|s)/);if(s)return Number(s[1]);let a=t.match(/(\d+)\s*m/);if(a)return Math.max(30,Math.round(Number(a[1])/3.5));let l=Number(t);return Number.isFinite(l)&&l>0?l:60}(e.work),name:"".concat(e.label).concat(e.reps>1?" x".concat(e.reps):"")}))})},[h]);let O=S>0?100/1609:.2,q=(0,a.useCallback)(()=>{k(e=>e+1),C(e=>e+O),I&&_(e=>{if(e<=1){let e=I.intervals;return R(t=>{let n=t+1;return n>=e.length?(E(t=>t>=I.rounds?(j(!1),t):(R(0),_(e[0].duration),t+1)),t):(_(e[n].duration),n)}),0}return e-1})},[I,O]);async function z(){j(!1),D(!0);let e=S>0&&N>0?N/60/S:null;await fetch("/api/cardio/log",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:(null==h?void 0:h.type)||x,sport:m||null,title:(null==h?void 0:h.title)||null,description:(null==h?void 0:h.description)||null,duration:N,distance:S||null,pace:e,calories:Math.round(y),routeData:W.current.length>0?W.current:null,intervals:I||null})}),D(!1),g("done")}if((0,a.useEffect)(()=>(v?B.current=setInterval(q,1e3):clearInterval(B.current),()=>clearInterval(B.current)),[v,q]),(0,a.useEffect)(()=>(v&&p.hasGPS&&navigator.geolocation&&(A.current=navigator.geolocation.watchPosition(e=>{let{latitude:t,longitude:n}=e.coords,s=[t,n];if(W.current.push(s),H.current){let[e,s]=H.current,a=Math.sin((t-e)*Math.PI/180/2)**2+Math.cos(e*Math.PI/180)*Math.cos(t*Math.PI/180)*Math.sin((n-s)*Math.PI/180/2)**2,l=7917.6*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));w(e=>e+l)}H.current=s},void 0,{enableHighAccuracy:!0})),()=>{A.current&&navigator.geolocation.clearWatch(A.current)}),[v,p.hasGPS]),"preview"===f&&h){var J;return(0,s.jsxs)("main",{className:"min-h-screen bg-black text-white p-5 pb-8",children:[(0,s.jsx)("button",{onClick:()=>e.back(),className:"text-neutral-400 text-sm",children:"← Back"}),(0,s.jsxs)("div",{className:"mt-4 rounded-2xl border border-[#262626] bg-[#141414] p-5",children:[(0,s.jsx)("p",{className:"text-xs text-neutral-500 uppercase tracking-wider",children:"Guided Cardio"}),(0,s.jsxs)("h1",{className:"mt-2 text-2xl font-bold",children:[p.icon," ",h.title]}),(0,s.jsxs)("div",{className:"mt-2 text-sm text-neutral-400",children:[h.duration," min \xb7 ",(0,s.jsx)("span",{className:"capitalize",children:h.intensity})]}),(0,s.jsx)("p",{className:"text-sm text-neutral-300 mt-4 leading-relaxed",children:h.description}),(null===(J=h.intervals)||void 0===J?void 0:J.length)?(0,s.jsxs)("div",{className:"mt-5 space-y-2",children:[(0,s.jsx)("p",{className:"text-xs text-neutral-500 uppercase tracking-wider",children:"Workout Structure"}),h.intervals.map((e,t)=>(0,s.jsxs)("div",{className:"rounded-xl bg-[#0f0f0f] border border-[#262626] p-3 text-sm",children:[(0,s.jsx)("p",{className:"font-semibold",children:e.label}),(0,s.jsxs)("p",{className:"text-xs text-neutral-400 mt-1",children:["Work: ",e.work," \xb7 Rest: ",e.rest," \xb7 Reps: ",e.reps]})]},"".concat(e.label,"-").concat(t)))]}):null,(0,s.jsx)("button",{onClick:function(){var e;(null==I?void 0:null===(e=I.intervals)||void 0===e?void 0:e.length)&&(E(1),R(0),_(I.intervals[0].duration)),g("tracking"),j(!0)},className:"mt-6 w-full py-3 rounded-xl bg-[#0066FF] font-semibold",children:"Start Guided Session"})]})]})}if("setup"===f&&p.hasIntervals)return(0,s.jsxs)("main",{className:"min-h-screen bg-black text-white",children:[(0,s.jsxs)("header",{className:"px-5 pt-8 pb-4 flex items-center gap-3",children:[(0,s.jsx)("button",{onClick:()=>e.back(),className:"text-neutral-400 text-sm",children:"← Back"}),(0,s.jsxs)("h1",{className:"font-bold",children:[p.icon," ",p.name]})]}),(0,s.jsx)(i,{onStart:function(e){F(e),E(1),R(0),_(e.intervals[0].duration),g("tracking"),j(!0)}})]});if("done"===f){let t=S>0&&N>0?N/60/S:0;return(0,s.jsxs)("main",{className:"min-h-screen bg-black text-white flex flex-col items-center justify-center p-6",children:[(0,s.jsx)("div",{className:"text-6xl mb-4",children:"\uD83C\uDF89"}),(0,s.jsxs)("h2",{className:"text-2xl font-bold mb-1",children:[(null==h?void 0:h.title)||p.name," Complete"]}),(0,s.jsx)("p",{className:"text-neutral-500 text-sm mb-8",children:"Great work. Here is your summary."}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3 w-full max-w-sm mb-8",children:[(0,s.jsx)(d,{label:"Duration",value:c(N),unit:""}),S>0&&(0,s.jsx)(d,{label:"Distance",value:S.toFixed(2),unit:"mi"}),S>0&&t>0&&(0,s.jsx)(d,{label:"Avg Pace",value:u(t),unit:"/mi"}),(0,s.jsx)(d,{label:"Calories",value:Math.round(y),unit:"cal"})]}),(0,s.jsx)("button",{onClick:()=>e.push("/workout"),className:"w-full max-w-sm py-4 bg-[#0066FF] text-white font-bold rounded-xl",children:"Done"})]})}let L=S>0&&N>0?N/60/S:0,Y=null==I?void 0:I.intervals[M];return(0,s.jsxs)("main",{className:"min-h-screen bg-black text-white flex flex-col",children:[(0,s.jsxs)("header",{className:"px-5 pt-8 pb-4 flex items-center justify-between",children:[(0,s.jsx)("button",{onClick:()=>e.back(),className:"text-neutral-400 text-sm",children:"← Back"}),(0,s.jsxs)("h1",{className:"font-bold",children:[p.icon," ",m||(null==h?void 0:h.title)||p.name]}),(0,s.jsx)("div",{className:"w-10"})]}),I&&Y&&(0,s.jsxs)("div",{className:"mx-5 mb-2 rounded-xl p-3 text-center ".concat("work"===Y.type?"bg-red-900/30 border border-red-900/40":"bg-green-900/30 border border-green-900/40"),children:[(0,s.jsx)("p",{className:"font-bold text-lg ".concat("work"===Y.type?"text-red-400":"text-[#00C853]"),children:Y.name}),(0,s.jsxs)("p",{className:"text-3xl font-mono font-bold",children:[T,"s"]}),(0,s.jsxs)("p",{className:"text-xs text-neutral-500 mt-1",children:["Round ",G," / ",I.rounds]})]}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center px-5 space-y-6",children:[(0,s.jsx)("div",{className:"text-7xl font-bold font-mono tracking-tight",children:c(N)}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3 w-full max-w-sm",children:[p.hasGPS&&(0,s.jsx)(d,{label:"Distance",value:S.toFixed(2),unit:"mi"}),p.hasGPS&&(0,s.jsx)(d,{label:"Pace",value:L>0?u(L):"--:--",unit:"/mi"}),(0,s.jsx)(d,{label:"Calories",value:Math.round(y),unit:"cal"}),(0,s.jsx)(d,{label:"Time",value:c(N),unit:""})]})]}),(0,s.jsxs)("div",{className:"px-5 pb-10 space-y-3",children:[v?(0,s.jsx)("button",{onClick:()=>j(!1),className:"w-full py-4 bg-[#FFB300] text-black font-bold rounded-xl text-lg",children:"Pause"}):0===N?(0,s.jsxs)("button",{onClick:()=>j(!0),className:"w-full py-4 bg-[#00C853] text-black font-bold rounded-xl text-lg",children:["Start ",(null==h?void 0:h.title)||p.name]}):(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsx)("button",{onClick:()=>j(!0),className:"py-4 bg-[#00C853] text-black font-bold rounded-xl",children:"Resume"}),(0,s.jsx)("button",{onClick:z,disabled:P,className:"py-4 bg-[#0066FF] text-white font-bold rounded-xl disabled:opacity-50",children:P?"Saving...":"Finish"})]}),v&&N>10&&(0,s.jsx)("button",{onClick:z,disabled:P,className:"w-full py-3 border border-[#262626] text-neutral-400 rounded-xl text-sm",children:"End Session"})]})]})}}},function(e){e.O(0,[6106,2971,7023,1744],function(){return e(e.s=61680)}),_N_E=e.O()}]);