(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[160],{1955:function(e,t,r){Promise.resolve().then(r.bind(r,155))},155:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return d}});var n=r(7437),s=r(2265),o=r(6463),a=r(2371);let l=["How's my progress this week?","Should I increase weight today?","Am I eating enough protein?","I feel tired — rest day or push through?","Why did you program these exercises?"];function i(){return(0,n.jsx)("div",{className:"flex gap-1 py-1",children:[0,1,2].map(e=>(0,n.jsx)("div",{className:"w-2 h-2 rounded-full bg-neutral-500 animate-bounce",style:{animationDelay:"".concat(.15*e,"s")}},e))})}function c(e){let{msg:t}=e,r="user"===t.role;return(0,n.jsxs)("div",{className:"flex ".concat(r?"justify-end":"justify-start"),children:[!r&&(0,n.jsx)("div",{className:"w-8 h-8 rounded-full bg-[#0066FF] flex items-center justify-center text-sm font-bold mr-2 flex-shrink-0 mt-0.5",children:"AI"}),(0,n.jsx)("div",{className:"max-w-[80%] rounded-2xl px-4 py-3 text-sm leading-relaxed whitespace-pre-wrap ".concat(r?"bg-[#0066FF] text-white rounded-tr-sm":"bg-[#1a1a1a] text-white border border-[#262626] rounded-tl-sm"),children:t.content})]})}function d(){(0,o.useRouter)();let[e,t]=(0,s.useState)([]),[r,d]=(0,s.useState)(""),[u,h]=(0,s.useState)(!1),[x,f]=(0,s.useState)(!1),[m,p]=(0,s.useState)(null),b=(0,s.useRef)(null),v=(0,s.useRef)(null),j=(0,s.useCallback)(()=>{var e;null===(e=b.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[]);(0,s.useEffect)(()=>{fetch("/api/coach/history").then(e=>e.json()).then(e=>{e.messages&&t(e.messages.map(e=>({...e,id:e.id||crypto.randomUUID()})))}).catch(()=>{}).finally(()=>f(!0))},[]),(0,s.useEffect)(()=>{x&&j()},[x,j]),(0,s.useEffect)(()=>{j()},[e,u,j]);let y=(0,s.useCallback)(async e=>{let n=(e||r).trim();if(!n||u)return;d(""),p(null);let s={id:crypto.randomUUID(),role:"user",content:n};t(e=>[...e,s]),h(!0);try{let e=await fetch("/api/coach/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:n})}),r=await e.json();if(!e.ok){p(r.message||r.error||"Coach unavailable"),t(e=>e.slice(0,-1));return}let s={id:crypto.randomUUID(),role:"assistant",content:r.response};t(e=>[...e,s])}catch(e){p("Network error — check your connection"),t(e=>e.slice(0,-1))}finally{var o;h(!1),null===(o=v.current)||void 0===o||o.focus()}},[r,u]),g=async()=>{confirm("Clear conversation history?")&&(await fetch("/api/coach/history",{method:"DELETE"}),t([]))};return(0,n.jsxs)("main",{className:"min-h-screen bg-black text-white flex flex-col pb-20",children:[(0,n.jsxs)("header",{className:"px-5 pt-6 pb-3 border-b border-[#1a1a1a] flex items-center justify-between flex-shrink-0",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-xs font-bold tracking-widest text-[#0066FF]",children:"FORC3"}),(0,n.jsx)("h1",{className:"text-xl font-bold",children:"AI Coach"}),(0,n.jsx)("p",{className:"text-xs text-neutral-500",children:"Personalized — knows your data"})]}),e.length>0&&(0,n.jsx)("button",{onClick:g,className:"text-xs text-neutral-600 hover:text-neutral-400 transition-colors",children:"Clear"})]}),(0,n.jsxs)("div",{className:"flex-1 overflow-y-auto px-4 py-4 space-y-4 min-h-0",children:[!x&&(0,n.jsx)("div",{className:"flex justify-center py-8",children:(0,n.jsx)("div",{className:"w-6 h-6 border-2 border-[#0066FF] border-t-transparent rounded-full animate-spin"})}),x&&0===e.length&&(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[50vh] text-center px-4",children:[(0,n.jsx)("div",{className:"text-5xl mb-4",children:"\uD83C\uDFCB️"}),(0,n.jsx)("h2",{className:"text-xl font-bold mb-2",children:"Your AI Coach"}),(0,n.jsx)("p",{className:"text-neutral-500 text-sm mb-6 max-w-xs",children:"Ask me anything about your training, nutrition, or recovery. I know your data."}),(0,n.jsx)("div",{className:"flex flex-wrap gap-2 justify-center",children:l.map(e=>(0,n.jsx)("button",{onClick:()=>y(e),className:"bg-[#141414] border border-[#262626] text-neutral-300 px-3 py-2 rounded-full text-sm hover:border-[#0066FF]/50 hover:text-white transition-all",children:e},e))})]}),e.map(e=>(0,n.jsx)(c,{msg:e},e.id)),u&&(0,n.jsxs)("div",{className:"flex justify-start",children:[(0,n.jsx)("div",{className:"w-8 h-8 rounded-full bg-[#0066FF] flex items-center justify-center text-sm font-bold mr-2 flex-shrink-0",children:"AI"}),(0,n.jsx)("div",{className:"bg-[#1a1a1a] border border-[#262626] rounded-2xl rounded-tl-sm px-4 py-3",children:(0,n.jsx)(i,{})})]}),m&&(0,n.jsxs)("div",{className:"bg-red-500/10 border border-red-500/30 rounded-xl px-4 py-3 text-sm text-red-400",children:[m,m.includes("ANTHROPIC_API_KEY")&&(0,n.jsx)("div",{className:"mt-2 text-xs text-neutral-500",children:"Add your API key to .env to enable the AI coach."})]}),(0,n.jsx)("div",{ref:b})]}),x&&e.length>0&&e.length<=4&&(0,n.jsx)("div",{className:"px-4 pb-2 flex gap-2 overflow-x-auto",children:l.slice(0,3).map(e=>(0,n.jsx)("button",{onClick:()=>y(e),className:"flex-shrink-0 bg-[#141414] border border-[#262626] text-neutral-400 px-3 py-1.5 rounded-full text-xs hover:text-white transition-colors",children:e},e))}),(0,n.jsxs)("div",{className:"px-4 py-3 border-t border-[#1a1a1a] flex gap-2 flex-shrink-0",children:[(0,n.jsx)("input",{ref:v,type:"text",value:r,onChange:e=>d(e.target.value),onKeyDown:e=>"Enter"===e.key&&!e.shiftKey&&y(),placeholder:"Ask your coach anything...",className:"flex-1 bg-[#141414] border border-[#262626] text-white rounded-full px-4 py-3 text-sm outline-none focus:border-[#0066FF] transition-colors placeholder:text-neutral-600"}),(0,n.jsx)("button",{onClick:()=>y(),disabled:u||!r.trim(),className:"w-12 h-12 rounded-full bg-[#0066FF] flex items-center justify-center text-white hover:bg-[#0052CC] transition-colors disabled:opacity-40 disabled:cursor-not-allowed flex-shrink-0",children:(0,n.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]}),(0,n.jsx)(a.Z,{active:"coach"})]})}},2371:function(e,t,r){"use strict";r.d(t,{Z:function(){return c}});var n=r(7437),s=r(7138),o=r(6463),a=r(2265);let l=[{id:"home",label:"Home",href:"/dashboard",icon:(0,n.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})},{id:"nutrition",label:"Nutrition",href:"/nutrition",icon:(0,n.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})},{id:"coach",label:"Coach",href:"/coach",icon:(0,n.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})},{id:"progress",label:"Progress",href:"/progress",icon:(0,n.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})},{id:"profile",label:"Profile",href:"/profile",icon:(0,n.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}],i=["home","nutrition","coach","progress","profile"];function c(e){let{active:t}=e,r=(0,o.useRouter)(),c=i.indexOf(t);return!function(e){let{onSwipeLeft:t,onSwipeRight:r,threshold:n=60}=e,s=(0,a.useRef)(null),o=(0,a.useRef)(null);(0,a.useEffect)(()=>{function e(e){s.current=e.touches[0].clientX,o.current=e.touches[0].clientY}function a(e){if(null===s.current||null===o.current)return;let a=e.changedTouches[0].clientX-s.current;Math.abs(a)>Math.abs(e.changedTouches[0].clientY-o.current)&&Math.abs(a)>n&&(a<0?null==t||t():null==r||r()),s.current=null,o.current=null}return document.addEventListener("touchstart",e,{passive:!0}),document.addEventListener("touchend",a,{passive:!0}),()=>{document.removeEventListener("touchstart",e),document.removeEventListener("touchend",a)}},[t,r,n])}({onSwipeLeft:()=>{c<i.length-1&&r.push(l.find(e=>e.id===i[c+1]).href)},onSwipeRight:()=>{c>0&&r.push(l.find(e=>e.id===i[c-1]).href)}}),(0,n.jsx)("nav",{className:"fixed bottom-0 left-0 right-0 bg-black border-t border-[#1a1a1a] px-2 py-2 safe-area-inset-bottom z-40",children:(0,n.jsx)("div",{className:"flex items-center justify-around max-w-lg mx-auto",children:l.map(e=>(0,n.jsxs)(s.default,{href:e.href,className:"flex flex-col items-center gap-1 py-1.5 px-3 rounded-xl transition-colors ".concat(t===e.id?"text-[#0066FF]":"text-[#666666] hover:text-neutral-300"),children:[e.icon,(0,n.jsx)("span",{className:"text-[10px] font-medium",children:e.label})]},e.id))})})}}},function(e){e.O(0,[291,971,23,744],function(){return e(e.s=1955)}),_N_E=e.O()}]);