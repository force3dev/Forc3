"use strict";(()=>{var e={};e.id=3004,e.ids=[3004],e.modules={53524:e=>{e.exports=require("@prisma/client")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},66733:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>w,patchFetch:()=>f,requestAsyncStorage:()=>h,routeModule:()=>g,serverHooks:()=>x,staticGenerationAsyncStorage:()=>v});var o={};r.r(o),r.d(o,{GET:()=>m,dynamic:()=>p});var s=r(49303),n=r(88716),i=r(60670),a=r(87070),d=r(61165),c=r(13538),l=r(62643),u=r(22718);let p="force-dynamic",y=["run","swim","bike","row","hiit"];async function m(){let e=await (0,d.getCurrentUserId)();if(!e)return a.NextResponse.json({error:"Unauthorized"},{status:401});let t=new Date,r=new Date(t);r.setDate(r.getDate()-1),r.setHours(0,0,0,0);let o=new Date(r);o.setHours(23,59,59,999);let s=new Date(t.getTime()-2592e5),n=new Date(t.getTime()-6048e5),[i,p,m,g]=await Promise.all([c.prisma.profile.findUnique({where:{userId:e}}),c.prisma.cardioActivity.findMany({where:{userId:e,completed:!0,completedAt:{gte:r,lte:o}},select:{intensity:!0}}),c.prisma.workoutLog.findMany({where:{userId:e,startedAt:{gte:s},completedAt:{not:null}},select:{startedAt:!0,overallRpe:!0},orderBy:{startedAt:"desc"}}),c.prisma.workoutLog.findMany({where:{userId:e,startedAt:{gte:n},completedAt:{not:null}},select:{startedAt:!0}})]),h=p.some(e=>["hard","max"].includes((e.intensity||"").toLowerCase()))||m.some(e=>e.startedAt>=r&&(e.overallRpe??0)>=8),v=m.filter(e=>(e.overallRpe??0)>=8).length,x=new Set(g.map(e=>e.startedAt.toISOString().slice(0,10))).size,w=(0,u.A)({workoutsLast3Days:m.length,hardWorkoutsLast3Days:v,restDaysLast7Days:7-x,consecutiveTrainingDays:0}),f=l.zr.map(e=>{var r,o;let s;return{...e,score:(r=t.getDay(),o=w.score,s=0,"easy"===e.intensity&&(s+=20),"moderate"===e.intensity&&(s+=14),"hard"===e.intensity&&(s+=8),"max"===e.intensity&&(s+=4),h&&("hard"===e.intensity||"max"===e.intensity)&&(s-=30),o<55&&("hard"===e.intensity||"max"===e.intensity)&&(s-=35),o>75&&"hard"===e.intensity&&(s+=10),6===r&&e.id.includes("long")&&(s+=30),s)}}).sort((e,t)=>t.score-e.score),D=f[0]?.id,A=y.map(e=>{let t=f.filter(t=>t.type===e||"run"===e&&"sprint"===t.type);return{type:e,options:t.map(e=>({id:e.id,title:e.title,description:e.description,duration:e.duration,intensity:e.intensity,recommended:e.id===D}))}}).filter(e=>e.options.length>0);return a.NextResponse.json({date:t.toISOString().slice(0,10),recoveryScore:w.score,recommendedWorkoutId:D,goal:i?.goal||null,groups:A})}let g=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/cardio/recommendations/route",pathname:"/api/cardio/recommendations",filename:"route",bundlePath:"app/api/cardio/recommendations/route"},resolvedPagePath:"C:\\Users\\Geric\\Desktop\\forc3\\src\\app\\api\\cardio\\recommendations\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:h,staticGenerationAsyncStorage:v,serverHooks:x}=g,w="/api/cardio/recommendations/route";function f(){return(0,i.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:v})}},22718:(e,t,r)=>{r.d(t,{A:()=>o});function o(e){let t,r,o;return o=100-15*e.hardWorkoutsLast3Days-8*e.workoutsLast3Days,e.consecutiveTrainingDays>=5&&(o-=20),o+=10*e.restDaysLast7Days,void 0!==e.userReportedSleep&&(o+=(e.userReportedSleep-7)*3),void 0!==e.userReportedEnergy&&(o+=(e.userReportedEnergy-6)*2),(o=Math.max(0,Math.min(100,Math.round(o))))>=85?(t="excellent",r="You're fully recovered. Push hard today — this is your day to set PRs."):o>=70?(t="good",r="Good recovery. Train as planned. Focus on progressive overload."):o>=55?(t="moderate",r="Moderate fatigue detected. Consider scaling back intensity by 10-15%."):o>=40?(t="low",r="Recovery is low. Stick to easy cardio or active recovery only today."):(t="rest_needed",r="Your body needs rest. Take the day off — growth happens in recovery."),{score:o,status:t,recommendation:r}}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[8948,5972,3112,1679],()=>r(66733));module.exports=o})();